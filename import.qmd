---
title: "Titre de votre page d'importation"
title-block-banner: true
description: | 
  Petite description de cette page.
# Importation de données
date: "2022-12-20"
# Modifier les détails que vous voulez
author:
  - name: "Abdoul Dramane TONDE"
    # Votre site web perso ou github
    url: https://github.com/Dramane98
    # les champs d'affiliation sont optionnels, vous pouvez les
    # comment out en ajoutant un # devant.
    affiliation: FAS1002
    affiliation-url: https://FAS1002.github.io/A22
    # changer pour votre propre orcid id
    # https://orcid.org/ pour vous inscrire.
    orcid: 0000-0000-0000-0000

# TRUE == Générer une citation pour cette page précise. Pour enlever, mettre false.
citation: true
# Inclure les références que vous utilisez dans vos rapports. Je conseille Zotero pour construire
# ce fichier ou de connecter RStudio directement pour pouvoir citer avec @nom-de-reference.
bibliography: references.bib
---

```{r echo=FALSE, warning=FALSE, message=FALSE}

library(tibble)
library(fs)
library(lubridate)
library(tidyverse)
library(skimr)
library(magrittr)
library(rvest)
```

```{r download, cache=TRUE}

URL <- "https://github.com/owid/co2-data/archive/refs/heads/master.zip"
dat <- data.frame(URL)
(dat <- as_tibble(dat))

raw_html <- read_html(x = URL)

raw_html

raw_body <- html_element(x = raw_html,
                         css = "body")

raw_body

html_text(x = raw_body, trim = TRUE)

items <- html_element(x = raw_body,
                         css = ".itemlist")
items

html_elements(x = items,
              css = ".titleline > a") %>% html_text()

base_raw_html <- read_html(x = URL)
base_html_table <- html_elements(x = base_raw_html, css = "table")
base_tables <- html_table(x = base_html_table)

base_tables$`Province/Territoire` <- ifelse(test = is.na(base_tables$`Province/Territoire`),
                                  yes = base_tables$Territoire, no = base_tables$`Province/Territoire`)
base_tables$Territoire <- NULL

rm(list=(ls(pattern = "base*")))


base_path <- path("data", "raw")

fname <- paste(today(), 
               "owid-co2-codebook.zip",
               sep = "_")

fpath <- path(base_path,
              fname)


download.file(url = URL,
              destfile = fpath)

```

V1: Le fichier a été téléchargé là:

data/raw/2022-12-18_owid-co2-codebook.zip.

V2: V1: Le fichier a été téléchargé là:`r fpath`

```{r extraction}

unzip(zipfile = fpath,
      exdir = base_path)

```

Nous voyons qu'il y a deux nouveaux fichiers: `r fs::dir_ls(base_path)`

```{r read}

df <- read.csv(file = path(base_path, "co2-data-master/owid-co2-codebook.csv"))

skim(df)
```
